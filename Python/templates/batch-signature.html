{% extends "base.html" %}

{% block content %}
<div class="container">
    <!-- Messages about the signature process will be rendered in here -->
    <div id="messagesPanel"></div>

    <h2>Batch Signature</h2>

    <form id="signForm" method="POST">

        <div class="form-group">
            <label>File to sign</label>

            <p>
            You'll be signing the following files:
            <!--
                UL element to hold the batch's documents (we'll render these programatically,
                see batch-signature-form.js
            -->
            <ul id="docList"/>
            </p>
        </div>

        <!--
            Render a select (combo box) to list the user's certificates. For now it will be empty, we'll populate it
            later on (see batch-signature-form.js)
        -->
        <div class="form-group">
            <label for="certificateSelect">Choose a certificate</label>
            <select id="certificateSelect" class="form-control"></select>
        </div>

        <!--
            Action button. Notice that the "Sign File" button is NOT a submit button. When the user clicks the button,
            we must first use the Web PKI component to perform the client-side computation necessary an only when that
            computation is finished we'll submit the form programatically (see batch-signature-form.js).
        -->
        <button id="signButton" type="button" class="btn btn-primary">Sign Batch</button>
        <button id="refreshButton" type="button" class="btn btn-default">Refresh Certificates</button>

    </form>
</div>

<!--
    The file below contains the logic for calling the Web PKI component. It is only an example, feel free to alter it
    to meet your application's needs. You can also bring the code into the javascript block below if you prefer.
-->
<script src="/static/js/batch-signature-form.js"></script>
<script>
    $(document).ready(function () {
        // Once the page is ready, we call the init() function on the javascript code (see batch-signature-form.js)
        batchSignatureForm.init({
            documentsIds: JSON.parse('{{ documents_ids | safe }}'), // ids of documents
            certificateSelect: $('#certificateSelect'), // the select element (combo box) to list the certificates
            refreshButton: $('#refreshButton'),         // the "refresh" button
            signButton: $('#signButton')                // the button that initiates the operation
        });
    });
</script>
{% endblock %}